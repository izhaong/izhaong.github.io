(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{450:function(s,a,e){"use strict";e.r(a);var t=e(4),n=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"shouldcomponentupdate-简称-scu"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shouldcomponentupdate-简称-scu"}},[s._v("#")]),s._v(" shouldComponentUpdate ( 简称 SCU )")]),s._v(" "),a("h4",{attrs:{id:"基本用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本用法"}},[s._v("#")]),s._v(" 基本用法")]),s._v(" "),a("div",{staticClass:"language-react line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("shouldComponentUpdate(nextProps, nextState) {\n  if (nextState.count !== this.state.count) {\n    return true // 可以渲染\n  }\n  return false // 不重复渲染\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("React 默认： 父组件有更新，子组件无条件也更新")]),s._v(" "),a("p",[s._v("SCU 在需要的时候才优化，不要为了开发而开发")]),s._v(" "),a("p",[s._v("需要配合到 不可变值")]),s._v(" "),a("p",[s._v("eg:")]),s._v(" "),a("div",{staticClass:"language-react line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("onSubmit = (value) => {\n  // right\n  this.setState({\n    list: this.state.list.concat({\n      id: `id_${Date.now()}`,\n      title: value\n    })\n  })\n  \n  // fail\n  this.state.list.push({\n    id: `id_${Date.now()}`,\n    title: value\n  })\n  this.setState({\n    list: this.state.list\n  })\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h4",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结：")]),s._v(" "),a("ul",[a("li",[s._v("SCU 默认返回true ，即 React 默认重新渲染所有子组件")]),s._v(" "),a("li",[s._v("必须配合 “ 不可变值 ” 一起使用")]),s._v(" "),a("li",[s._v("可先不用 SCU， 有性能问题时再考虑")])]),s._v(" "),a("h3",{attrs:{id:"purecomponent-和-react-memo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#purecomponent-和-react-memo"}},[s._v("#")]),s._v(" PureComponent 和 React.memo")]),s._v(" "),a("ul",[a("li",[s._v("PureCompnent ， SCU 中实现了浅比较")]),s._v(" "),a("li",[s._v("memo， 函数组件中的 PureComponent")]),s._v(" "),a("li",[s._v("浅比较已使用大部分情况 （ 尽量不要做深度比较）")])]),s._v(" "),a("h4",{attrs:{id:"purecomponent-eg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#purecomponent-eg"}},[s._v("#")]),s._v(" PureComponent eg")]),s._v(" "),a("div",{staticClass:"language-react line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("class List extends React.PureComponent {\n  constructor(props) { ... }\n  \n  render() { ... }\n  \n  sholdComponentUpdate() { /*浅比较*/ }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"memo-eg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#memo-eg"}},[s._v("#")]),s._v(" memo eg")]),s._v(" "),a("div",{staticClass:"language-react line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function MyComponent (props) {\n  /* 使用 props 渲染 */\n}\nfunction areEqual(prevProps, nextProps）{\n  /*\n  如果把 nextProps 传入 render 方法的返回结果与\n  将 prevProps 传入 render 方法的返回结果一致则返回 true,\n  否则返回 false\n  */\n}\nexport default React.memo(MyComponent, areEqual);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"不可变值-immutable-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不可变值-immutable-js"}},[s._v("#")]),s._v(" 不可变值 immutable.js")]),s._v(" "),a("ul",[a("li",[s._v("基于共享数据（不是深拷贝），速度好")]),s._v(" "),a("li",[s._v("有一定的学习和迁移成本，按需使用")])]),s._v(" "),a("p",[s._v("e g：")]),s._v(" "),a("div",{staticClass:"language-react line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const map1 = Immutable.Map({ a: 1, b: 2, c: 3 })\nconst map2 = map1.set({ 'b', 50 })\nmap1.get('b')  // 2\nmap2.get('b')  // 50\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);