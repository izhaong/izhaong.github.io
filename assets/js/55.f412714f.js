(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{394:function(e,s,a){"use strict";a.r(s);var n=a(4),r=Object(n.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"运行任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行任务"}},[e._v("#")]),e._v(" 运行任务")]),e._v(" "),s("p",[e._v("Monorepos可以有数百甚至数千个项目，所以能够对所有(或部分)项目运行npm脚本是Lerna这样的工具的一个关键特性。")]),e._v(" "),s("h3",{attrs:{id:"定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定义"}},[e._v("#")]),e._v(" 定义")]),e._v(" "),s("ul",[s("li",[s("strong",[e._v("Command")]),e._v(" - 开发者在终端中键入的任何内容 （e.g., "),s("code",[e._v("lerna run build --scope=header --concurrency=5")]),e._v("）")]),e._v(" "),s("li",[s("strong",[e._v("Target")]),e._v(" - npm脚本的名称(e.g., "),s("code",[e._v("build")]),e._v(")")]),e._v(" "),s("li",[s("strong",[e._v("Task")]),e._v(" - npm脚本的调用(e.g., "),s("code",[e._v("header:build")]),e._v(").")])]),e._v(" "),s("h3",{attrs:{id:"示例仓库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例仓库"}},[e._v("#")]),e._v(" 示例仓库")]),e._v(" "),s("blockquote",[s("p",[e._v("例子基于 "),s("a",{attrs:{href:"https://github.com/lerna/getting-started-example",target:"_blank",rel:"noopener noreferrer"}},[e._v("this repository"),s("OutboundLink")],1)])]),e._v(" "),s("h3",{attrs:{id:"运行内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行内容"}},[e._v("#")]),e._v(" 运行内容")]),e._v(" "),s("p",[e._v("每个项目都定义了"),s("code",[e._v("test")]),e._v("和"),s("code",[e._v("build")]),e._v("脚本。")]),e._v(" "),s("p",[e._v("run:")]),e._v(" "),s("p",[s("code",[e._v("npx lerna run build")])]),e._v(" "),s("p",[e._v("这将以正确的顺序构建项目: "),s("code",[e._v("footer")]),e._v(" and "),s("code",[e._v("header")]),e._v(" and then "),s("code",[e._v("remixapp")]),e._v(".")]),e._v(" "),s("div",{staticClass:"language-Terminal line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("    ✔  header:build (501ms)\n    ✔  footer:build (503ms)\n    ✔  remixapp:build (670ms)\n\n —————————————————————————————————————————————————————————————————————————————\n\n >  Lerna (powered by Nx)   Successfully ran target build for 3 projects (1s)\n\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br")])]),s("p",[e._v("请注意，Lerna并不关心每个构建脚本的作用。名称build也不特殊：它只是npm脚本的名称。")]),e._v(" "),s("h3",{attrs:{id:"同时运行多个任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#同时运行多个任务"}},[e._v("#")]),e._v(" 同时运行多个任务")]),e._v(" "),s("p",[e._v("您可以传递一个逗号分隔的目标列表，其中列出了您希望触发并发运行的目标。")]),e._v(" "),s("p",[s("code",[e._v("npx lerna run test,build,lint")])]),e._v(" "),s("p",[e._v("例如，如果您的任务之间存在依赖关系，例如需要在测试特定包之前运行构建，那么只要您配置了适当的任务管道配置，任务运行器就会为您协调这一点。")]),e._v(" "),s("h3",{attrs:{id:"为单个包运行任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为单个包运行任务"}},[e._v("#")]),e._v(" 为单个包运行任务")]),e._v(" "),s("p",[e._v("在开发时，您很少运行所有构建或所有测试。相反，您通常只针对正在更改的项目进行操作。例如，您可以这样运行头测试：")]),e._v(" "),s("p",[s("code",[e._v("npx lerna run test --scope=header")])]),e._v(" "),s("h3",{attrs:{id:"运行受pr影响的任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行受pr影响的任务"}},[e._v("#")]),e._v(" 运行受PR影响的任务")]),e._v(" "),s("p",[e._v("您还可以为PR中受影响的所有项目运行命令，如下所示：")]),e._v(" "),s("p",[s("code",[e._v("npx lerna run test --since=origin/main")])]),e._v(" "),s("p",[e._v("Learn more "),s("a",{attrs:{href:"https://lerna.js.org/docs/api-reference/commands",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"控制任务的运行方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#控制任务的运行方式"}},[e._v("#")]),e._v(" 控制任务的"),s("a",{attrs:{href:"https://lerna.js.org/docs/features/run-tasks#control-how-tasks-run",target:"_blank",rel:"noopener noreferrer"}},[e._v("运行方式"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("要更好地控制执行任务的顺序，请编辑"),s("a",{attrs:{href:"https://lerna.js.org/docs/concepts/task-pipeline-configuration",target:"_blank",rel:"noopener noreferrer"}},[e._v("Task Pipeline Configuration"),s("OutboundLink")],1),e._v("。")]),e._v(" "),s("p",[e._v("要加快任务执行速度，请了解如何"),s("a",{attrs:{href:"https://lerna.js.org/docs/features/cache-tasks",target:"_blank",rel:"noopener noreferrer"}},[e._v("缓存任务结果"),s("OutboundLink")],1),e._v("和"),s("a",{attrs:{href:"https://lerna.js.org/docs/features/distribute-tasks",target:"_blank",rel:"noopener noreferrer"}},[e._v("分配任务执行"),s("OutboundLink")],1)]),e._v(" "),s("h3",{attrs:{id:"自动加载-env文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动加载-env文件"}},[e._v("#")]),e._v(" 自动加载 .env"),s("a",{attrs:{href:"https://lerna.js.org/docs/features/run-tasks#automatic-loading-of-env-files",target:"_blank",rel:"noopener noreferrer"}},[e._v("文件"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("默认情况下，由 Nx 提供支持的现代任务运行器将自动"),s("code",[e._v(".env")]),e._v("为您加载文件。"),s("code",[e._v("--load-env-files")]),e._v("如果您出于任何原因想要禁用此行为，您可以设置为 false。")]),e._v(" "),s("p",[e._v("有关"),s("code",[e._v(".env")]),e._v("默认加载哪些文件的更多详细信息，请参阅："),s("a",{attrs:{href:"https://nx.dev/recipes/environment-variables/define-environment-variables",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://nx.dev/recipes/environment-variables/define-environment-variables"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"版本和发布"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#版本和发布"}},[e._v("#")]),e._v(" 版本和发布")]),e._v(" "),s("p",[e._v("Lerna 可以增加您的包的版本以及将您的包发布到 NPM，它提供了多种选项以确保可以适应任何工作流程。")]),e._v(" "),s("p",[e._v("为了展示 Lerna 是如何做到的，我们将查看"),s("a",{attrs:{href:"https://github.com/lerna/getting-started-example",target:"_blank",rel:"noopener noreferrer"}},[e._v("这个存储库"),s("OutboundLink")],1),e._v("。")]),e._v(" "),s("blockquote",[s("p",[e._v("如果您通过实践学得更好，请克隆 repo 并继续学习。")])]),e._v(" "),s("p",[e._v("回购协议包含三个包或项目：")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("header")]),e._v("（React 组件库）")]),e._v(" "),s("li",[s("code",[e._v("footer")]),e._v("（React 组件库）")]),e._v(" "),s("li",[s("code",[e._v("remixapp")]),e._v("（使用依赖于"),s("code",[e._v("header")]),e._v("和的 Remix 框架编写的应用程序"),s("code",[e._v("footer")]),e._v("）")])]),e._v(" "),s("p",[e._v("我们将发布"),s("code",[e._v("header")]),e._v("和"),s("code",[e._v("footer")]),e._v("包。")]),e._v(" "),s("blockquote",[s("p",[e._v("只发布项目的一个子集是很常见的。有些项目可以是私有的（例如，仅用于测试），有些可以是演示应用程序。在这个 repo 中，"),s("code",[e._v("remixapp")]),e._v("它不是私有的，它只是没有发布到 NPM。")])]),e._v(" "),s("h3",{attrs:{id:"版本控制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#版本控制"}},[e._v("#")]),e._v(" "),s("a",{attrs:{href:"https://lerna.js.org/docs/features/version-and-publish#versioning",target:"_blank",rel:"noopener noreferrer"}},[e._v("版本控制"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("Lerna 附带一个"),s("code",[e._v("version")]),e._v("命令，允许您增加包的版本号、提交更改并相应地标记它们。")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("lerna version --no-private\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("你会得到以下输出：")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("lerna notice cli v5.1.2\nlerna info current version "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".0\nlerna info Assuming all packages changed\n? Select a new version "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("currently "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("Use arrow keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n❯ Patch "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  Minor "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.1")]),e._v(".0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  Major "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2.0")]),e._v(".0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  Prepatch "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".1-alpha.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  Preminor "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.1")]),e._v(".0-alpha.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  Premajor "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2.0")]),e._v(".0-alpha.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  Custom Prerelease\n  Custom Version\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br")])]),s("p",[e._v("信息")]),e._v(" "),s("p",[e._v("请注意，通过传递，我们排除了在其文件"),s("code",[e._v("--no-private")]),e._v("中标记的所有包。"),s("code",[e._v("private``package.json")])]),e._v(" "),s("p",[e._v("Lerna 检测当前包，识别当前版本并建议下一个选择。请注意，您也可以像"),s("code",[e._v("lerna version 1.0.0")]),e._v(". 有关"),s("a",{attrs:{href:"https://github.com/lerna/lerna/tree/main/libs/commands/version#readme",target:"_blank",rel:"noopener noreferrer"}},[e._v("版本文档详细信息"),s("OutboundLink")],1),e._v("的更多信息。一旦选择了给定的版本，Lerna 就会"),s("code",[e._v("package.json")]),e._v("用版本号更新，提交更改，添加相应的版本标签（例如"),s("code",[e._v("v1.0.0")]),e._v("）并将提交和标签推送到远程存储库。")]),e._v(" "),s("p",[e._v("包/页脚/package.json")]),e._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"footer"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1.0.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"main"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"dist/index.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  ...\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("请注意，上述操作不会将包推送到任何 NPM 存储库。相反，如果我们还希望 Lerna 负责发布过程，我们可以使用"),s("code",[e._v("lerna publish")]),e._v("instead。")]),e._v(" "),s("p",[e._v("信息")]),e._v(" "),s("p",[e._v("lerna使用in的"),s("code",[e._v("version")]),e._v("属性"),s("code",[e._v("lerna.json")]),e._v("来判断当前使用的版本")]),e._v(" "),s("h3",{attrs:{id:"发布到npm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#发布到npm"}},[e._v("#")]),e._v(" 发布到"),s("a",{attrs:{href:"https://lerna.js.org/docs/features/version-and-publish#publishing-to-npm",target:"_blank",rel:"noopener noreferrer"}},[e._v("NPM"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("如果我们跑")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("lerna publish --no-private\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("Lerna 执行版本递增工作流（与 相同"),s("code",[e._v("lerna version")]),e._v("），此外还将包推送到 NPM。您应该得到以下输出：")]),e._v(" "),s("p",[e._v("终端输出")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("lerna notice cli v5.1.2\nlerna info current version "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".0\nlerna info Assuming all packages changed\n? Select a new version "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("currently "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" Patch "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\nChanges:\n - footer: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".1\n - header: "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".1\n\n? Are you sure you want to publish these packages? Yes\nlerna info execute Skipping releases\nlerna info "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" Pushing tags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nlerna info publish Publishing packages to npm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nlerna success published header "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".1\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nlerna success published footer "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".1\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nSuccessfully published:\n - footer@1.0.1\n - header@1.0.1\nlerna success published "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" packages\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br")])]),s("h3",{attrs:{id:"版本控制策略"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#版本控制策略"}},[e._v("#")]),e._v(" 版本控制"),s("a",{attrs:{href:"https://lerna.js.org/docs/features/version-and-publish#versioning-strategies",target:"_blank",rel:"noopener noreferrer"}},[e._v("策略"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("Lerna 允许您使用两种模式之一来管理您的项目：固定或独立。")]),e._v(" "),s("h4",{attrs:{id:"固定-锁定模式-默认"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#固定-锁定模式-默认"}},[e._v("#")]),e._v(" 固定/锁定模式（默认"),s("a",{attrs:{href:"https://lerna.js.org/docs/features/version-and-publish#fixedlocked-mode-default",target:"_blank",rel:"noopener noreferrer"}},[e._v("）"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("固定模式 Lerna 项目在单个版本行上运行。该版本保存在"),s("code",[e._v("lerna.json")]),e._v("项目根目录下的文件中"),s("code",[e._v("version")]),e._v("。当您运行 时"),s("code",[e._v("lerna publish")]),e._v("，如果模块自上次发布以来已更新，它将更新为您发布的新版本。这意味着您只在需要时发布包的新版本。")]),e._v(" "),s("blockquote",[s("p",[e._v("注意：如果您的主要版本为零，则所有更新都被"),s("a",{attrs:{href:"https://semver.org/#spec-item-4",target:"_blank",rel:"noopener noreferrer"}},[e._v("视为中断"),s("OutboundLink")],1),e._v("。因此，"),s("code",[e._v("lerna publish")]),e._v("以零主版本运行并选择任何非预发布版本号将导致为所有包发布新版本，即使自上次发布以来并非所有包都发生了变化。")])]),e._v(" "),s("p",[e._v("如果您想自动将所有包版本绑定在一起，请使用此选项。这种方法的一个问题是任何包中的重大更改都会导致所有包都具有新的主要版本。")]),e._v(" "),s("h4",{attrs:{id:"独立模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#独立模式"}},[e._v("#")]),e._v(" 独立"),s("a",{attrs:{href:"https://lerna.js.org/docs/features/version-and-publish#independent-mode",target:"_blank",rel:"noopener noreferrer"}},[e._v("模式"),s("OutboundLink")],1)]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("npx lerna init --independent\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("独立模式 Lerna 项目允许维护者彼此独立地增加包版本。每次发布时，您都会收到针对每个已更改包的提示，以指定它是补丁、次要、主要还是自定义更改。")]),e._v(" "),s("p",[e._v("独立模式允许您更具体地更新每个包的版本，并且对一组组件有意义。"),s("a",{attrs:{href:"https://github.com/semantic-release/semantic-release",target:"_blank",rel:"noopener noreferrer"}},[e._v("将这种模式与语义释放"),s("OutboundLink")],1),e._v("之类的东西结合起来会减轻它的痛苦。（在"),s("a",{attrs:{href:"https://github.com/atlassian/lerna-semantic-release",target:"_blank",rel:"noopener noreferrer"}},[e._v("atlassian/lerna-semantic-release"),s("OutboundLink")],1),e._v("已经有这方面的工作）。")]),e._v(" "),s("blockquote",[s("p",[e._v("将"),s("code",[e._v("version")]),e._v("键设置"),s("code",[e._v("lerna.json")]),e._v("为"),s("code",[e._v("independent")]),e._v("以独立模式运行。")])])])}),[],!1,null,null,null);s.default=r.exports}}]);